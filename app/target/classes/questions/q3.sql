-- Question 3

-- utilisation d'une date "mock" car notre date n'est pas active
-- le temps de travail journalier max est de 3h
 WITH IN_THE_DAY AS
	(SELECT AMBULANCIER_ID,
			DURATION
		FROM AMBULANCESYSTEM.INTERVENTION
		WHERE INTERVENTION_DATE = '2022-04-18' ),
	HEURE_CUMULEE AS
	(SELECT AMBULANCIER_ID,
			(SUM(DURATION) / 60) AS TIME_IN_HOURS
		FROM IN_THE_DAY
		GROUP BY AMBULANCIER_ID)
SELECT FNAME,
	LNAME,
	TIME_IN_HOURS
FROM HEURE_CUMULEE
JOIN AMBULANCESYSTEM.AMBULANCIER ON HEURE_CUMULEE.AMBULANCIER_ID = AMBULANCIER.AMBULANCIER_ID
WHERE TIME_IN_HOURS < 3
ORDER BY TIME_IN_HOURS